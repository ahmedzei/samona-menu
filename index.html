<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>×ª×¤×¨×™×˜ ×¡×××•× ×”</title>
  <link rel="icon" href="pics/logo.jpg" type="image/jpeg" />
  <link rel="apple-touch-icon" href="pics/logo.jpg" />
  <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; }
    html { overflow-x: hidden; -webkit-text-size-adjust: 100%; min-height: 100vh; }
    body {
      font-family: 'Assistant', sans-serif;
      margin: 0 auto;
      padding: 0;
      max-width: 600px;
      min-height: 100vh;
      color: #222;
      line-height: 1.5;
      position: relative;
      background-image: linear-gradient(rgba(250,249,247,0.25), rgba(250,249,247,0.25)), url('pics/view_compressed.JPG');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: scroll;
    }

    /* â”€â”€â”€ Header â”€â”€â”€ */
    .menu-header {
      text-align: center;
      padding: 1rem 1rem 0.75rem;
      background: #FFFFFF;
      border-bottom: 1px solid #eee;
    }
    .menu-header .logo {
      display: block;
      margin: 0 auto;
      height: 100px;
      width: auto;
      object-fit: contain;
    }

    /* â”€â”€â”€ Home view â”€â”€â”€ */
    .view-home { display: block; padding-bottom: 2rem; }
    .view-home.hidden { display: none !important; }

    .hero {
      text-align: center;
      padding: 2rem 1rem;
      background: rgba(0,0,0,0.04);
      margin: 0 1rem 1rem;
      border-radius: 12px;
    }
    .hero .tagline-hero {
      font-size: 1.35rem;
      font-weight: 700;
      color: #333;
      margin: 0;
    }

    /* Horizontal category strip */
    .category-strip {
      display: flex;
      overflow-x: auto;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      margin: 0 0 0.5rem;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .category-strip::-webkit-scrollbar { display: none; }
    .cat-pill {
      flex-shrink: 0;
      font-family: 'Assistant', sans-serif;
      font-size: 0.95rem;
      font-weight: 600;
      padding: 0.6rem 1rem;
      border-radius: 999px;
      border: 1px solid #DE6629;
      background: #DE6629;
      color: #fff;
      cursor: pointer;
      white-space: nowrap;
      transition: background 0.2s, border-color 0.2s;
    }
    .cat-pill:hover, .cat-pill:focus { background: #C55A20; border-color: #C55A20; outline: none; }
    .cat-pill.active { background: #B8521E; color: #fff; border-color: #B8521E; }

    /* One section per category (title + item row + ×”×¦×’ ×”×›×œ) */
    .category-section {
      margin-bottom: 1.5rem;
    }
    .category-section-title {
      font-size: 1.35rem;
      font-weight: 700;
      margin: 0 1rem 0.5rem;
      color: #111;
      scroll-margin-top: 0.5rem;
    }

    /* Horizontal item row */
    .item-row {
      display: flex;
      overflow-x: auto;
      gap: 1rem;
      padding: 0 1rem 1rem;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .item-row::-webkit-scrollbar { display: none; }

    .item-card {
      flex-shrink: 0;
      width: 165px;
      border-radius: 12px;
      overflow: hidden;
      background: rgba(250,249,247,0.9);
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      cursor: pointer;
      transition: transform 0.15s, box-shadow 0.15s;
    }
    .item-card:active { transform: scale(0.98); }
    .item-card .card-photo {
      width: 100%;
      height: 140px;
      background: #e8e8e8;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .item-card .card-photo img { width: 100%; height: 100%; object-fit: cover; }
    .item-card .card-photo.no-photo { color: #999; font-size: 0.75rem; padding: 0.5rem; text-align: center; }
    .item-card .card-name {
      font-weight: 700;
      font-size: 1rem;
      padding: 0.5rem 0.6rem 0.25rem;
      color: #111;
      line-height: 1.3;
    }
    .item-card .card-price {
      padding: 0 0.6rem 0.6rem;
      font-size: 0.95rem;
      font-weight: 600;
      color: #111;
    }
    .price-pill,
    .item-card .card-price .price-pill {
      display: inline-block;
      background: #DE6629;
      color: #fff;
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      font-size: 0.9rem;
    }

    .btn-show-all {
      display: block;
      margin: 0 1rem 1rem;
      padding: 0.65rem 1.15rem;
      font-family: 'Assistant', sans-serif;
      font-size: 1rem;
      font-weight: 600;
      text-align: center;
      background: #DE6629;
      color: #fff;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }
    .btn-show-all:hover, .btn-show-all:focus { background: #C55A20; outline: none; }

    /* â”€â”€â”€ Category page (full list) â”€â”€â”€ */
    .view-category {
      display: none;
      padding-bottom: 2rem;
    }
    .view-category.visible { display: block; }

    .category-toolbar {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      background: rgba(250,249,247,0.95);
      border-bottom: 1px solid #e0e0e0;
    }
    .btn-back {
      flex-shrink: 0;
      font-family: 'Assistant', sans-serif;
      font-size: 1rem;
      font-weight: 600;
      padding: 0.5rem 1rem;
      background: #DE6629;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .btn-back:hover, .btn-back:focus { background: #C55A20; outline: none; }
    .category-page-title { margin: 0; font-size: 1.25rem; font-weight: 700; color: #111; }

    .category-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      padding: 1rem;
    }
    .category-grid .item-card {
      width: 100%;
      max-width: 100%;
    }
    .category-grid .item-card .card-photo { height: 120px; }

    /* â”€â”€â”€ Item modal (popup) â”€â”€â”€ */
    #item-modal {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 100;
      background: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
      padding: 1rem;
      box-sizing: border-box;
    }
    #item-modal.open { display: flex; }
    .modal-content {
      background: #fff;
      border-radius: 16px;
      max-width: 400px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
      position: relative;
    }
    .modal-close {
      position: absolute;
      top: 0.75rem;
      left: 0.75rem;
      width: 36px;
      height: 36px;
      border: none;
      background: rgba(0,0,0,0.1);
      border-radius: 50%;
      font-size: 1.25rem;
      line-height: 1;
      cursor: pointer;
      z-index: 2;
    }
    .modal-close:hover { background: rgba(0,0,0,0.2); }
    .modal-item-photo {
      width: 100%;
      height: 220px;
      background: #e8e8e8;
      object-fit: cover;
    }
    .modal-item-photo-placeholder {
      width: 100%;
      height: 120px;
      background: #e8e8e8;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #999;
      font-size: 0.9rem;
    }
    .modal-item-body { padding: 1.25rem 1rem; text-align: center; }
    .modal-item-body .name { font-size: 1.35rem; font-weight: 700; color: #111; margin-bottom: 0.5rem; }
    .modal-item-body .prices { margin-bottom: 0.75rem; }
    .modal-item-body .description { font-size: 0.95rem; color: #555; line-height: 1.5; text-align: right; }
    .modal-item-body .tags { font-size: 0.875rem; color: #666; margin-top: 0.5rem; }

    /* â”€â”€â”€ Footer â”€â”€â”€ */
    .menu-footer {
      text-align: center;
      padding: 2rem 1rem 1rem;
      border-top: 1px solid rgba(0,0,0,0.08);
      font-size: 0.9rem;
      color: #666;
      line-height: 1.6;
      background: rgba(250, 249, 247, 0.7);
    }
    .menu-footer p { margin: 0.35rem 0; }
    .menu-footer a { color: #444; text-decoration: none; }
    .menu-footer a:hover { text-decoration: underline; }
  </style>
</head>
<body>

  <header class="menu-header">
    <img class="logo" src="pics/logo.jpg" alt="×¡×××•× ×”" />
  </header>

  <div class="view-home" id="viewHome">
    <div class="hero">
      <p class="tagline-hero">××”×˜××‘×•×Ÿ ×‘××”×‘×”</p>
    </div>
    <div class="category-strip" id="categoryStrip"></div>
    <div id="categorySections"></div>
  </div>

  <div class="view-category" id="viewCategory">
    <div class="category-toolbar">
      <button type="button" class="btn-back" id="btnBack">×—×–×•×¨</button>
      <h2 class="category-page-title" id="categoryPageTitle"></h2>
    </div>
    <div class="category-grid" id="categoryGrid"></div>
  </div>

  <div id="item-modal" aria-hidden="true">
    <div class="modal-content">
      <button type="button" class="modal-close" id="modalClose" aria-label="×¡×’×•×¨">Ã—</button>
      <div id="modalPhoto"></div>
      <div class="modal-item-body">
        <div class="name" id="modalName"></div>
        <div class="prices" id="modalPrices"></div>
        <div class="description" id="modalDescription"></div>
        <div class="tags" id="modalTags"></div>
      </div>
    </div>
  </div>

  <footer class="menu-footer">
    <p>×›×œ ×”×× ×•×ª ××•×›× ×•×ª ×‘××§×•×</p>
    <p>× ×™×ª×Ÿ ×œ×©××•×œ ×¢×œ ××œ×¨×’× ×™×</p>
    <p><a href="https://www.instagram.com/sammona_cafe/?hl=en" target="_blank" rel="noopener">@sammona_cafe</a></p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTKosa_uR5CFcW4e335cn8KG-1WjoWGDlFiATxRs0kX9SuSU5sUHiUgwJ4KmPnVaMGmHhDYuR3nAbPA/pub?gid=809200224&single=true&output=csv";

    const TAG_ICONS = { ×˜×‘×¢×•× ×™: 'ğŸŒ±', ×—×œ×‘×™: 'ğŸ§€', ×—×¨×™×£: 'ğŸŒ¶', ×‘×©×¨×™: 'ğŸ¥©', ×¤×¨×•×•×”: 'ğŸ¥¬' };
    const LOGO_PATH = 'pics/logo.jpg';

    const PHOTO_MAP = {
      '×¤×•×§×¦×³×” ×˜×¨×™×™×”': 'pics/×¤×•×§×¦×”.jpeg', '××¨×•×—×ª ×‘×•×§×¨ ×¡×××•× ×”': 'pics/××¨×•×—×ª ×‘×•×§×¨.jpeg', '×˜×•×¡×˜ ×˜××‘×•×Ÿ': 'pics/×˜×•×¡×˜.jpeg',
      '×¡×××•× ×” ×©× ×™×¦×œ': LOGO_PATH,
      '×©×§×©×•×§×”': 'pics/×©×§×©×•×§×”.jpeg',
      '××¨×’×¨×™×˜×” ×™×œ×“×™×': 'pics/××¨×’×¨×™×˜×”.jpeg', '×˜××‘×•×œ×” ×˜××‘×•×Ÿ': 'pics/×˜××‘×•×œ×”.jpeg',
      '×¡×œ×˜ ×¤×˜×•×©': 'pics/×¤×˜×•×©.jpeg', '×¡×œ×˜ ×©×¨×™ ×¤×¡×˜×•': 'pics/×¡×œ×˜ ×©×™×¨×™ ×¤×¡×˜×•.jpeg', '×¡×œ×˜×•×Ÿ ××™×©×™': 'pics/×¡×œ×˜×•×Ÿ ××™×©×™.jpeg',
      '××¨×’×¨×™×˜×”': 'pics/××¨×’×¨×™×˜×”.jpeg',
      '×©×¨×™ ×¤×¡×˜×•': 'pics/×©×™×¨×™ ×¤×¡×˜×•.jfif', '×‘×™×× ×§×” ×¤×˜×¨×™×•×ª': 'pics/×‘×™×× ×§×”.jpeg', '×¤×¤×¨×•× ×™': 'pics/×¤×¤×¨×•× ×™.jpg',
      '×–×¢×ª×¨': 'pics/×–×¢×ª×¨.jpeg',
      '×›×¨×™×š ××‘×•×§×“×•': 'pics/××‘×•×§××“×•.jpeg', '×›×¨×™×š ××‘×•×§××“×•': 'pics/××‘×•×§××“×•.jpeg', '××‘×•×§×“×•': 'pics/××‘×•×§××“×•.jpeg',
      '×›×¨×™×š ×©× ×™×¦×œ': 'pics/×›×¨×™×š ×©× ×™×¦×œ.jpeg', '×©× ×™×¦×œ': 'pics/×©× ×™×¦×œ.jpeg',
      '×¢×•×£ ××ª×•×‘×œ': 'pics/×¢×•×£.jpeg', '×—×‘×™×ª×”': 'pics/×—×‘×™×ª×”.jpeg',
      '×§×™× ×•×— ×¡×××•× ×”': 'pics/×§×™× ×•×— ×¡×××•× ×”.jpeg',
      '×§× ××¤×”': 'pics/×§× ××¤×” ×—×“×©.jpeg', '×›× ××¤×”': 'pics/×§× ××¤×” ×—×“×©.jpeg',
      '××¡×¤×¨×¡×•': 'pics/××¡×¤×¨×¡×•.jpg', '×××¨×™×§×× ×• ×—×': 'pics/×××¨×™×§×× ×• ×—×.png', '×§×•×¨×˜×“×•': 'pics/×§×•×¨×˜×“×•.png', '×”×¤×•×š': 'pics/×”×¤×•×š.jpeg',
      '×©×•×§×• ×—×': 'pics/×©×•×§×• ×—×.png', '×§×¤×” ×¢×¨×‘×™': 'pics/×§×¤×” ×¢×¨×‘×™.png', '×××¨×™×§×× ×• ×§×¨': 'pics/×××¨×™×§×× ×• ×§×¨.png',
      '×œ×™××•× ×“×”': 'pics/×œ×™××•× ×“×”.png', '×§×¤×” ×§×¨': 'pics/×§×¤×” ×§×¨.png', '××©×§××•×ª ××•×’×–×™×': 'pics/××©×§××•×ª ××•×’×–×™×.png',
      '×¡×—×•×˜ ×˜×¨×™': 'pics/×¡×—×•×˜ ×˜×¨×™ ×ª×¤×•×–×™×.png', '×ª×¤×•×–×™×': 'pics/×¡×—×•×˜ ×˜×¨×™ ×ª×¤×•×–×™×.png',
      "×¦'×™×¤×¡": "pics/×¦×™×¤×¡.png",
      "××™× ××™× ×¨×œ×™× / ×¡×•×“×”": "pics/××™× ×× ×™×¨×œ×.jpg"
    };

    function getItemPhoto(item, category) {
      const photoCol = (item.photo || item.image || '').trim();
      if (photoCol) return photoCol.startsWith('pics/') ? photoCol : 'pics/' + photoCol;
      const name = (item.name || '').trim();
      if (category === '×›×¨×™×›×™×' && name === '×©× ×™×¦×œ') return 'pics/×›×¨×™×š ×©× ×™×¦×œ.jpeg';
      for (const [key, path] of Object.entries(PHOTO_MAP))
        if (name.indexOf(key) !== -1) return path;
      return LOGO_PATH;
    }
    function getTagLabel(tag) {
      const t = (tag || '').trim();
      return t && TAG_ICONS[t] ? TAG_ICONS[t] + ' ' + t : t || '';
    }
    function parseTags(tagsStr) {
      if (!tagsStr || !String(tagsStr).trim()) return [];
      return String(tagsStr).split(/[,ØŒ]/).map(s => s.trim()).filter(Boolean);
    }
    function formatPrice(amount, sizeLabel) {
      if (!amount || amount === '' || amount === '-') return null;
      const num = String(amount).trim();
      return { num, size: sizeLabel ? ' Â· ' + sizeLabel : '' };
    }
    function getSizeLabels(category, item) {
      const fromSheet = (item.size_small || item.price_small_label || '').trim();
      const fromSheetLarge = (item.size_large || item.price_large_label || '').trim();
      if (fromSheet || fromSheetLarge) return { small: fromSheet || '××™×©×™', large: fromSheetLarge || '××©×¤×—×ª×™×ª' };
      const cat = (category || '').trim();
      if (cat === '×‘×•×§×¨') return { small: '××™×©×™', large: '×–×•×’×™' };
      if (cat === '×¤×™×¦×•×ª') return { small: '×¨×’×™×œ×”', large: '×¢× ×§×™×ª' };
      if (cat === '×©×ª×™×™×” ×—××”' || cat === '×©×ª×™×™×” ×§×¨×”') return { small: '×¨×’×™×œ', large: '×’×“×•×œ' };
      return { small: '××™×©×™', large: '××©×¤×—×ª×™×ª' };
    }

    function buildPriceText(category, item) {
      const labels = getSizeLabels(category, item);
      const pSmall = formatPrice(item.price_small, item.price_large ? labels.small : null);
      const pLarge = formatPrice(item.price_large, item.price_large ? labels.large : null);
      const parts = [];
      if (pSmall) parts.push(pSmall.num + ' â‚ª' + pSmall.size);
      if (pLarge) parts.push(pLarge.num + ' â‚ª' + pLarge.size);
      return parts.join('  ');
    }

    function buildPricePill(category, item) {
      const labels = getSizeLabels(category, item);
      const pSmall = formatPrice(item.price_small, item.price_large ? labels.small : null);
      const pLarge = formatPrice(item.price_large, item.price_large ? labels.large : null);
      const parts = [];
      if (pSmall) parts.push(pSmall.num + ' â‚ª' + pSmall.size);
      if (pLarge) parts.push(pLarge.num + ' â‚ª' + pLarge.size);
      return parts.join('  ');
    }

    let menuData = { grouped: {}, categories: [] };

    function renderItemCard(item, category, container, isGrid) {
      const card = document.createElement('div');
      card.className = 'item-card';
      const photoSrc = getItemPhoto(item, category);
      const photoHtml = `<div class="card-photo"><img src="${photoSrc}" alt="" loading="lazy" /></div>`;
      const pricePill = buildPricePill(category, item);
      const name = (item.name || '').trim();
      card.innerHTML = photoHtml + `<div class="card-name">${name}</div><div class="card-price"><span class="price-pill">${pricePill}</span></div>`;
      card.addEventListener('click', () => openItemModal(item, category));
      container.appendChild(card);
    }

    function renderAllCategories() {
      const strip = document.getElementById('categoryStrip');
      const container = document.getElementById('categorySections');
      strip.innerHTML = '';
      container.innerHTML = '';
      const cats = menuData.categories;

      cats.forEach((c, idx) => {
        const pill = document.createElement('button');
        pill.type = 'button';
        pill.className = 'cat-pill';
        pill.textContent = c;
        pill.setAttribute('data-category-index', idx);
        pill.addEventListener('click', () => {
          const el = document.getElementById('cat-' + idx);
          if (el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });
        strip.appendChild(pill);
      });

      cats.forEach((cat, idx) => {
        const section = document.createElement('section');
        section.className = 'category-section';
        section.id = 'cat-' + idx;

        const title = document.createElement('h2');
        title.className = 'category-section-title';
        title.textContent = cat;
        section.appendChild(title);

        const row = document.createElement('div');
        row.className = 'item-row';
        (menuData.grouped[cat] || []).forEach(item => renderItemCard(item, cat, row, false));
        section.appendChild(row);

        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'btn-show-all';
        btn.textContent = '×”×¦×’ ×”×›×œ';
        btn.addEventListener('click', () => showCategoryPage(idx));
        section.appendChild(btn);

        container.appendChild(section);
      });
    }

    function showCategoryPage(categoryIndex) {
      const cat = menuData.categories[categoryIndex];
      if (!cat) return;
      document.getElementById('viewHome').classList.add('hidden');
      document.getElementById('viewCategory').classList.add('visible');
      document.getElementById('categoryPageTitle').textContent = cat;
      const grid = document.getElementById('categoryGrid');
      grid.innerHTML = '';
      (menuData.grouped[cat] || []).forEach(item => renderItemCard(item, cat, grid, true));
    }

    function hideCategoryPage() {
      document.getElementById('viewCategory').classList.remove('visible');
      document.getElementById('viewHome').classList.remove('hidden');
    }

    function openItemModal(item, category) {
      const name = (item.name || '').trim();
      const desc = (item.description || '').trim();
      const tags = parseTags(item.tags).map(getTagLabel).filter(Boolean);
      const priceText = buildPriceText(category, item);
      const photoSrc = getItemPhoto(item, category);

      document.getElementById('modalName').textContent = name;
      document.getElementById('modalPrices').innerHTML = priceText ? `<span class="price-pill">${priceText}</span>` : '';
      document.getElementById('modalDescription').textContent = desc;
      document.getElementById('modalTags').innerHTML = tags.length ? tags.map(t => `<span>${t}</span> `).join('') : '';

      const photoEl = document.getElementById('modalPhoto');
      photoEl.innerHTML = `<img src="${photoSrc}" alt="" class="modal-item-photo" />`;

      const modal = document.getElementById('item-modal');
      modal.classList.add('open');
      modal.setAttribute('aria-hidden', 'false');
    }

    function closeItemModal() {
      const modal = document.getElementById('item-modal');
      modal.classList.remove('open');
      modal.setAttribute('aria-hidden', 'true');
    }

    document.getElementById('btnBack').addEventListener('click', hideCategoryPage);
    document.getElementById('modalClose').addEventListener('click', closeItemModal);
    document.getElementById('item-modal').addEventListener('click', function(e) {
      if (e.target === this) closeItemModal();
    });

    Papa.parse(csvUrl, {
      download: true,
      header: true,
      complete: function(results) {
        const rows = results.data || [];
        if (!rows.length) {
          document.getElementById('viewHome').innerHTML = '<p style="padding:2rem;text-align:center;color:#666;">×œ× × ×™×ª×Ÿ ×œ×˜×¢×•×Ÿ ××ª ×”×ª×¤×¨×™×˜.</p>';
          return;
        }
        const isAvailable = (v) => { const s = String(v || '').trim().toLowerCase(); return s === 'true' || s === '1' || s === 'yes'; };
        const grouped = {};
        rows.forEach(row => {
          if (!isAvailable(row.available)) return;
          const cat = (row.category || '').trim();
          if (!cat) return;
          if (!grouped[cat]) grouped[cat] = [];
          grouped[cat].push(row);
        });
        const sortNum = (row) => { const n = parseInt(row.sort, 10); return Number.isNaN(n) ? 9999 : n; };
        Object.keys(grouped).forEach(c => grouped[c].sort((a, b) => sortNum(a) - sortNum(b)));
        menuData = { grouped, categories: Object.keys(grouped) };
        renderAllCategories();
      }
    });
  </script>
</body>
</html>
